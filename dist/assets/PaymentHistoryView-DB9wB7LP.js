import{d as P,o as D,c as n,b as t,u as x,t as s,k as l,l as m,y as v,x as H,a as k,F as V,r as z,i as g,n as h,f as p,h as i,_ as M}from"./index-C-TcrSO1.js";import{u as B}from"./payment.store-DtsOKpvG.js";import"./api.service-BvZdgALs.js";const S={class:"container mx-auto px-4 py-8"},L={key:0,class:"mb-6 p-4 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded-md"},N={key:1,class:"flex justify-center items-center py-16"},I={class:"mb-6 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700"},$={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},F={class:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden"},T={class:"overflow-x-auto"},U={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},A={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},E={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},q={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400"},G={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},J={class:"px-6 py-4 whitespace-nowrap"},K={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400"},O={class:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400"},Q={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},R=["onClick"],W={key:0,class:"px-6 py-12 text-center"},X={key:1,class:"bg-white dark:bg-gray-800 px-4 py-3 flex items-center justify-between border-t border-gray-200 dark:border-gray-700 sm:px-6"},Y={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},Z={class:"text-sm text-gray-700 dark:text-gray-300"},tt={class:"font-medium"},et={class:"font-medium"},at={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},st={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full p-6"},rt={class:"flex justify-between items-center mb-6"},dt={key:0,class:"space-y-6"},ot={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},nt={class:"space-y-2"},it={class:"flex justify-between"},lt={class:"text-sm font-medium text-gray-900 dark:text-white"},ut={class:"flex justify-between"},xt={class:"text-sm font-medium text-gray-900 dark:text-white"},yt={class:"flex justify-between"},gt={class:"text-sm font-medium text-gray-900 dark:text-white"},mt={class:"flex justify-between"},pt={class:"flex justify-between"},ft={class:"text-sm font-medium text-gray-900 dark:text-white"},ct={key:0,class:"flex justify-between"},bt={class:"text-sm font-medium text-gray-900 dark:text-white"},vt={class:"space-y-2"},kt={class:"flex justify-between"},ht={class:"text-sm font-medium text-gray-900 dark:text-white"},wt={key:0,class:"flex justify-between"},_t={class:"text-sm font-medium text-gray-900 dark:text-white"},jt={class:"flex justify-between"},Ct={class:"text-sm font-medium text-gray-900 dark:text-white"},Pt={class:"space-y-2"},Dt={class:"flex justify-between"},Ht={class:"text-sm font-medium text-gray-900 dark:text-white"},Vt={key:0,class:"flex justify-between"},zt={class:"text-sm font-medium text-gray-900 dark:text-white"},Mt={class:"mt-6 flex justify-end"},Bt=P({__name:"PaymentHistoryView",setup(St){const d=B(),y=p(!1),a=p(null),u=p({start_date:"",end_date:"",status:"",limit:20,offset:0});D(async()=>{await d.fetchPaymentHistory()});const w=o=>o?new Date(o).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}):"-",f=o=>o?new Date(o).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-",c=o=>{switch(o){case"completed":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300";case"failed":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";case"refunded":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},b=o=>{switch(o){case"completed":return"已完成";case"pending":return"处理中";case"failed":return"失败";case"refunded":return"已退款";default:return"未知"}},_=async()=>{await d.fetchPaymentHistory(u.value)},j=async()=>{u.value={start_date:"",end_date:"",status:"",limit:20,offset:0},await d.fetchPaymentHistory()},C=async o=>{try{a.value=await d.fetchPaymentDetails(o),y.value=!0}catch(e){console.error("获取支付详情失败:",e)}};return(o,e)=>(i(),n("div",S,[e[35]||(e[35]=t("div",{class:"mb-8"},[t("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"},"支付历史"),t("p",{class:"mt-2 text-gray-600 dark:text-gray-400"},"查看您的支付记录")],-1)),x(d).error?(i(),n("div",L,s(x(d).error),1)):l("",!0),x(d).loading?(i(),n("div",N,[...e[5]||(e[5]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"},null,-1)])])):l("",!0),t("div",I,[t("div",$,[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"开始日期",-1)),m(t("input",{type:"date","onUpdate:modelValue":e[0]||(e[0]=r=>u.value.start_date=r),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,512),[[v,u.value.start_date]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"结束日期",-1)),m(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=r=>u.value.end_date=r),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,512),[[v,u.value.end_date]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"支付状态",-1)),m(t("select",{"onUpdate:modelValue":e[2]||(e[2]=r=>u.value.status=r),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},[...e[8]||(e[8]=[k('<option value="" data-v-6afbef02>全部状态</option><option value="completed" data-v-6afbef02>已完成</option><option value="pending" data-v-6afbef02>处理中</option><option value="failed" data-v-6afbef02>失败</option><option value="refunded" data-v-6afbef02>已退款</option>',5)])],512),[[H,u.value.status]])])]),t("div",{class:"mt-4 flex justify-end"},[t("button",{onClick:_,class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," 应用筛选 "),t("button",{onClick:j,class:"ml-3 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," 重置 ")])]),t("div",F,[t("div",T,[t("table",U,[e[10]||(e[10]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," 支付 ID "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," 日期 "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," 金额 "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," 状态 "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," 支付方式 "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," 描述 "),t("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," 操作 ")])],-1)),t("tbody",A,[(i(!0),n(V,null,z(x(d).paymentHistory,r=>(i(),n("tr",{key:r.id},[t("td",E,s(r.id),1),t("td",q,s(w(r.created_at)),1),t("td",G,s(r.amount)+" "+s(r.currency),1),t("td",J,[t("span",{class:h(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",c(r.status)])},s(b(r.status)),3)]),t("td",K,s(r.payment_method.type==="credit_card"?`${r.payment_method.brand} 卡`:r.payment_method.type==="paypal"?"PayPal":r.payment_method.type==="crypto"?"加密货币":"银行转账"),1),t("td",O,s(r.subscription_id?"订阅支付":"其他支付"),1),t("td",Q,[t("button",{onClick:Lt=>C(r.id),class:"text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300 focus:outline-none"}," 查看详情 ",8,R)])]))),128))])])]),x(d).paymentHistory.length===0?(i(),n("div",W,[...e[11]||(e[11]=[t("svg",{class:"h-16 w-16 text-gray-400 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"})],-1),t("h3",{class:"mt-4 text-lg font-medium text-gray-900 dark:text-white"},"暂无支付记录",-1),t("p",{class:"mt-2 text-gray-600 dark:text-gray-400"},"您还没有任何支付记录",-1)])])):l("",!0),x(d).paymentHistory.length>0?(i(),n("div",X,[e[18]||(e[18]=t("div",{class:"flex-1 flex justify-between sm:hidden"},[t("a",{href:"#",class:"relative inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"}," 上一页 "),t("a",{href:"#",class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"}," 下一页 ")],-1)),t("div",Y,[t("div",null,[t("p",Z,[e[12]||(e[12]=g(" 显示第 ",-1)),e[13]||(e[13]=t("span",{class:"font-medium"},"1",-1)),e[14]||(e[14]=g(" 到 ",-1)),t("span",tt,s(x(d).paymentHistory.length),1),e[15]||(e[15]=g(" 条，共 ",-1)),t("span",et,s(x(d).paymentHistory.length),1),e[16]||(e[16]=g(" 条记录 ",-1))])]),e[17]||(e[17]=k('<div data-v-6afbef02><nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px" aria-label="Pagination" data-v-6afbef02><a href="#" class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm font-medium text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-600" data-v-6afbef02><span class="sr-only" data-v-6afbef02>上一页</span><svg class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20" data-v-6afbef02><path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" data-v-6afbef02></path></svg></a><a href="#" aria-current="page" class="z-10 bg-blue-50 dark:bg-blue-900/30 border-blue-500 text-blue-600 dark:text-blue-400 relative inline-flex items-center px-4 py-2 border text-sm font-medium" data-v-6afbef02> 1 </a><a href="#" class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm font-medium text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-600" data-v-6afbef02><span class="sr-only" data-v-6afbef02>下一页</span><svg class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20" data-v-6afbef02><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" data-v-6afbef02></path></svg></a></nav></div>',1))])])):l("",!0)]),y.value?(i(),n("div",at,[t("div",st,[t("div",rt,[e[20]||(e[20]=t("h3",{class:"text-xl font-bold text-gray-900 dark:text-white"},"支付详情",-1)),t("button",{onClick:e[3]||(e[3]=r=>y.value=!1),class:"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400"},[...e[19]||(e[19]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),a.value?(i(),n("div",dt,[t("div",ot,[t("div",null,[e[27]||(e[27]=t("h4",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},"支付信息",-1)),t("div",nt,[t("div",it,[e[21]||(e[21]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"支付 ID",-1)),t("span",lt,s(a.value.id),1)]),t("div",ut,[e[22]||(e[22]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"交易 ID",-1)),t("span",xt,s(a.value.transaction_id),1)]),t("div",yt,[e[23]||(e[23]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"金额",-1)),t("span",gt,s(a.value.amount)+" "+s(a.value.currency),1)]),t("div",mt,[e[24]||(e[24]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"状态",-1)),t("span",{class:h(["text-sm font-medium px-2 py-1 rounded-full",c(a.value.status)])},s(b(a.value.status)),3)]),t("div",pt,[e[25]||(e[25]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"创建时间",-1)),t("span",ft,s(f(a.value.created_at)),1)]),a.value.updated_at?(i(),n("div",ct,[e[26]||(e[26]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"更新时间",-1)),t("span",bt,s(f(a.value.updated_at)),1)])):l("",!0)])]),t("div",null,[e[31]||(e[31]=t("h4",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},"支付方式",-1)),t("div",vt,[t("div",kt,[e[28]||(e[28]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"类型",-1)),t("span",ht,s(a.value.payment_method.type==="credit_card"?"信用卡/借记卡":a.value.payment_method.type==="paypal"?"PayPal":a.value.payment_method.type==="crypto"?"加密货币":"银行转账"),1)]),a.value.payment_method.type==="credit_card"?(i(),n("div",wt,[e[29]||(e[29]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"品牌",-1)),t("span",_t,s(a.value.payment_method.brand),1)])):l("",!0),t("div",jt,[e[30]||(e[30]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"账号",-1)),t("span",Ct,s(a.value.payment_method.type==="credit_card"?`**** ${a.value.payment_method.last_four}`:a.value.payment_method.last_four),1)])])])]),t("div",null,[e[34]||(e[34]=t("h4",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},"其他信息",-1)),t("div",Pt,[t("div",Dt,[e[32]||(e[32]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"描述",-1)),t("span",Ht,s(a.value.subscription_id?"订阅支付":"其他支付"),1)]),a.value.subscription_id?(i(),n("div",Vt,[e[33]||(e[33]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"订阅 ID",-1)),t("span",zt,s(a.value.subscription_id),1)])):l("",!0)])])])):l("",!0),t("div",Mt,[t("button",{onClick:e[4]||(e[4]=r=>y.value=!1),class:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," 关闭 ")])])])):l("",!0)]))}}),Ft=M(Bt,[["__scopeId","data-v-6afbef02"]]);export{Ft as default};
//# sourceMappingURL=PaymentHistoryView-DB9wB7LP.js.map
