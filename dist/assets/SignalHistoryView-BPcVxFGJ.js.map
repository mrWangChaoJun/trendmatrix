{"version":3,"file":"SignalHistoryView-BPcVxFGJ.js","sources":["../../src/frontend/src/views/signals/SignalHistoryView.vue"],"sourcesContent":["<template>\n  <div class=\"container mx-auto px-4 py-6\">\n    <h1 class=\"text-2xl font-bold text-primary dark:text-white\">TrendMatrix</h1>\n    <p class=\"text-gray-600 dark:text-gray-400 mt-1\">历史信号记录</p>\n\n    <!-- 过滤和搜索 -->\n    <div class=\"mt-4 flex flex-col md:flex-row gap-4\">\n      <div class=\"flex-1\">\n        <input\n          v-model=\"searchQuery\"\n          type=\"text\"\n          placeholder=\"搜索信号...\"\n          class=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white\"\n        />\n      </div>\n      <div class=\"flex gap-2\">\n        <select\n          v-model=\"filterType\"\n          class=\"px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white\"\n        >\n          <option value=\"all\">所有类型</option>\n          <option value=\"trend\">趋势</option>\n          <option value=\"momentum\">动量</option>\n          <option value=\"reversal\">反转</option>\n        </select>\n        <button\n          @click=\"loadSignals\"\n          class=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n        >\n          刷新\n        </button>\n      </div>\n    </div>\n\n    <!-- 信号列表 -->\n    <div class=\"mt-6\">\n      <div class=\"card\">\n        <div class=\"card-header flex items-center justify-between\">\n          <h3 class=\"font-medium text-gray-900 dark:text-white\">历史信号</h3>\n          <span class=\"text-sm text-gray-600 dark:text-gray-400\">{{ filteredSignals.length }} 个信号</span>\n        </div>\n        <div class=\"overflow-x-auto\">\n          <table class=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n            <thead class=\"bg-gray-50 dark:bg-gray-800\">\n              <tr>\n                <th class=\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">资产</th>\n                <th class=\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">类型</th>\n                <th class=\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">强度</th>\n                <th class=\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">时间</th>\n                <th class=\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">操作</th>\n              </tr>\n            </thead>\n            <tbody class=\"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800\">\n              <tr v-for=\"signal in paginatedSignals\" :key=\"signal.id\" class=\"hover:bg-gray-50 dark:hover:bg-gray-800\">\n                <td class=\"px-4 py-3 whitespace-nowrap\">\n                  <div class=\"text-sm font-medium text-gray-900 dark:text-white\">{{ signal.asset }}</div>\n                </td>\n                <td class=\"px-4 py-3 whitespace-nowrap\">\n                  <span :class=\"['inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium', getSignalTypeClass(signal.type)]\">\n                    {{ signal.type }}\n                  </span>\n                </td>\n                <td class=\"px-4 py-3 whitespace-nowrap\">\n                  <div class=\"flex items-center\">\n                    <div class=\"w-16 bg-gray-200 dark:bg-gray-700 rounded-full h-2\">\n                      <div :class=\"['h-2 rounded-full', getSignalStrengthClass(signal.strength)]\" :style=\"{ width: signal.strength + '%' }\"></div>\n                    </div>\n                    <span class=\"ml-2 text-xs text-gray-600 dark:text-gray-400\">{{ signal.strength }}%</span>\n                  </div>\n                </td>\n                <td class=\"px-4 py-3 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400\">\n                  {{ formatTime(signal.timestamp) }}\n                </td>\n                <td class=\"px-4 py-3 whitespace-nowrap text-sm font-medium\">\n                  <router-link :to=\"`/signals/${signal.id}`\" class=\"text-blue-600 dark:text-blue-400 hover:underline\">查看详情</router-link>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n        <!-- 分页 -->\n        <div class=\"card-footer flex items-center justify-between px-4 py-3\">\n          <div class=\"text-sm text-gray-600 dark:text-gray-400\">\n            显示 {{ (currentPage - 1) * pageSize + 1 }} 到 {{ Math.min(currentPage * pageSize, filteredSignals.length) }} 共 {{ filteredSignals.length }} 个信号\n          </div>\n          <div class=\"flex space-x-2\">\n            <button\n              @click=\"currentPage = Math.max(1, currentPage - 1)\"\n              :disabled=\"currentPage === 1\"\n              class=\"px-3 py-1 border border-gray-300 dark:border-gray-700 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              上一页\n            </button>\n            <button\n              @click=\"currentPage = Math.min(Math.ceil(filteredSignals.length / pageSize), currentPage + 1)\"\n              :disabled=\"currentPage === Math.ceil(filteredSignals.length / pageSize)\"\n              class=\"px-3 py-1 border border-gray-300 dark:border-gray-700 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              下一页\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, onMounted } from 'vue'\nimport localDbService from '../../services/db/local-db.service'\n\n// 状态数据\nconst isLoading = ref(false)\nconst error = ref('')\nconst signals = ref<any[]>([])\nconst searchQuery = ref('')\nconst filterType = ref('all')\nconst currentPage = ref(1)\nconst pageSize = ref(10)\n\n\n\n// 计算属性\nconst filteredSignals = computed(() => {\n  let result = [...signals.value]\n\n  // 按搜索词过滤\n  if (searchQuery.value) {\n    const query = searchQuery.value.toLowerCase()\n    result = result.filter(signal =>\n      signal.asset.toLowerCase().includes(query)\n    )\n  }\n\n  // 按类型过滤\n  if (filterType.value !== 'all') {\n    result = result.filter(signal => signal.type === filterType.value)\n  }\n\n  // 按时间排序\n  result.sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime())\n\n  return result\n})\n\nconst paginatedSignals = computed(() => {\n  const start = (currentPage.value - 1) * pageSize.value\n  const end = start + pageSize.value\n  return filteredSignals.value.slice(start, end)\n})\n\n// 工具函数\nfunction getSignalTypeClass(type: string): string {\n  const classes = {\n    trend: 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200',\n    momentum: 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200',\n    reversal: 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200'\n  }\n  return classes[type as keyof typeof classes] || 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n}\n\nfunction getSignalStrengthClass(strength: number): string {\n  if (strength >= 80) return 'bg-green-500'\n  if (strength >= 60) return 'bg-yellow-500'\n  if (strength >= 40) return 'bg-orange-500'\n  return 'bg-red-500'\n}\n\nfunction formatTime(timestamp: string): string {\n  return new Intl.DateTimeFormat('zh-CN', {\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit'\n  }).format(new Date(timestamp))\n}\n\n// 加载信号数据\nasync function loadSignals() {\n  isLoading.value = true\n  error.value = ''\n  try {\n    // 从本地数据库获取信号数据\n    const recentSignals = await localDbService.getRecentSignals(50) // 获取更多信号用于历史记录\n    signals.value = recentSignals\n    currentPage.value = 1 // 重置到第一页\n  } catch (err) {\n    error.value = '获取信号数据失败'\n    console.error('Error loading signals:', err)\n  } finally {\n    isLoading.value = false\n  }\n}\n\n// 组件挂载时加载数据\nonMounted(() => {\n  loadSignals()\n})\n</script>\n\n<style scoped>\n/* 组件特定样式 */\n</style>\n"],"names":["isLoading","ref","error","signals","searchQuery","filterType","currentPage","pageSize","filteredSignals","computed","result","query","signal","a","b","paginatedSignals","start","end","getSignalTypeClass","type","getSignalStrengthClass","strength","formatTime","timestamp","loadSignals","recentSignals","localDbService","err","onMounted","_openBlock","_createElementBlock","_hoisted_1","_cache","_createElementVNode","_hoisted_2","_hoisted_3","$event","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_toDisplayString","_hoisted_9","_hoisted_10","_hoisted_11","_Fragment","_renderList","_hoisted_12","_hoisted_13","_hoisted_14","_normalizeClass","_hoisted_15","_hoisted_16","_hoisted_17","_normalizeStyle","_hoisted_18","_hoisted_19","_hoisted_20","_createVNode","_component_router_link","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25"],"mappings":"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"}