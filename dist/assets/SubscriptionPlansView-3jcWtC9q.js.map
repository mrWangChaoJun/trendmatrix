{"version":3,"file":"SubscriptionPlansView-3jcWtC9q.js","sources":["../../src/frontend/src/views/subscription/SubscriptionPlansView.vue"],"sourcesContent":["<template>\n  <div class=\"container mx-auto px-4 py-8\">\n    <div class=\"mb-8\">\n      <h1 class=\"text-3xl font-bold text-gray-900 dark:text-white\">订阅计划</h1>\n      <p class=\"mt-2 text-gray-600 dark:text-gray-400\">选择适合您需求的订阅计划</p>\n    </div>\n\n    <!-- 错误提示 -->\n    <div v-if=\"subscriptionStore.error\" class=\"mb-6 p-4 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded-md\">\n      {{ subscriptionStore.error }}\n    </div>\n\n    <!-- 加载状态 -->\n    <div v-if=\"subscriptionStore.loading\" class=\"flex justify-center items-center py-16\">\n      <div class=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n    </div>\n\n    <!-- 订阅计划卡片 -->\n    <div v-else class=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n      <div \n        v-for=\"plan in subscriptionStore.subscriptionPlans\" \n        :key=\"plan.id\"\n        class=\"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden border border-gray-200 dark:border-gray-700 hover:shadow-lg transition-shadow\"\n      >\n        <div class=\"p-6\">\n          <div class=\"text-center mb-6\">\n            <h3 class=\"text-xl font-bold text-gray-900 dark:text-white\">{{ plan.name }}</h3>\n            <p class=\"mt-2 text-gray-600 dark:text-gray-400\">{{ plan.description }}</p>\n            <div class=\"mt-4\">\n              <span class=\"text-3xl font-bold text-gray-900 dark:text-white\">{{ plan.price }}</span>\n              <span class=\"text-gray-600 dark:text-gray-400\">{{ plan.currency }}/{{ plan.billing_cycle }}</span>\n            </div>\n          </div>\n\n          <div class=\"mb-6\">\n            <h4 class=\"text-sm font-medium text-gray-900 dark:text-white mb-3\">包含功能</h4>\n            <ul class=\"space-y-2\">\n              <li v-for=\"(feature, index) in plan.features\" :key=\"index\" class=\"flex items-start\">\n                <svg class=\"h-5 w-5 text-green-500 mr-2 mt-0.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"></path>\n                </svg>\n                <span class=\"text-gray-600 dark:text-gray-400\">{{ feature }}</span>\n              </li>\n            </ul>\n          </div>\n\n          <div class=\"mb-6\">\n            <h4 class=\"text-sm font-medium text-gray-900 dark:text-white mb-3\">使用限制</h4>\n            <div class=\"space-y-2\">\n              <div class=\"flex justify-between items-center\">\n                <span class=\"text-gray-600 dark:text-gray-400\">API 调用限制</span>\n                <span class=\"font-medium text-gray-900 dark:text-white\">{{ plan.api_rate_limit }} 次/分钟</span>\n              </div>\n              <div class=\"flex justify-between items-center\">\n                <span class=\"text-gray-600 dark:text-gray-400\">信号生成限制</span>\n                <span class=\"font-medium text-gray-900 dark:text-white\">{{ plan.signal_limit }} 个/月</span>\n              </div>\n            </div>\n          </div>\n\n          <button \n            @click=\"selectPlan(plan)\"\n            :disabled=\"subscriptionStore.loading\"\n            class=\"w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            选择计划\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- 选择计划弹窗 -->\n    <div v-if=\"selectedPlan\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6\">\n        <div class=\"text-center mb-6\">\n          <h3 class=\"text-xl font-bold text-gray-900 dark:text-white\">确认订阅</h3>\n          <p class=\"mt-2 text-gray-600 dark:text-gray-400\">您选择了 {{ selectedPlan.name }} 计划</p>\n          <div class=\"mt-4\">\n            <span class=\"text-2xl font-bold text-gray-900 dark:text-white\">{{ selectedPlan.price }}</span>\n            <span class=\"text-gray-600 dark:text-gray-400\">{{ selectedPlan.currency }}/{{ selectedPlan.billing_cycle }}</span>\n          </div>\n        </div>\n\n        <div class=\"mb-6\">\n          <h4 class=\"text-sm font-medium text-gray-900 dark:text-white mb-3\">支付方式</h4>\n          <div v-if=\"paymentStore.userPaymentMethods.length > 0\">\n            <div \n              v-for=\"method in paymentStore.userPaymentMethods\" \n              :key=\"method.id\"\n              class=\"flex items-center p-3 border border-gray-200 dark:border-gray-700 rounded-md mb-2 cursor-pointer\"\n              :class=\"{ 'border-blue-500 bg-blue-50 dark:bg-blue-900/30': selectedPaymentMethodId === method.id }\"\n              @click=\"selectedPaymentMethodId = method.id\"\n            >\n              <div class=\"flex items-center\">\n                <input \n                  type=\"radio\" \n                  :id=\"`payment-${method.id}`\"\n                  :name=\"'payment-method'\"\n                  :checked=\"selectedPaymentMethodId === method.id\"\n                  @change=\"selectedPaymentMethodId = method.id\"\n                  class=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                >\n                <label \n                  :for=\"`payment-${method.id}`\"\n                  class=\"ml-2 block text-sm text-gray-900 dark:text-gray-300\"\n                >\n                  {{ method.type === 'credit_card' ? `${method.brand} ****${method.last_four}` : method.type }}\n                </label>\n              </div>\n              <div v-if=\"method.is_default\" class=\"ml-auto\">\n                <span class=\"text-xs font-medium text-blue-600 dark:text-blue-400 bg-blue-100 dark:bg-blue-900/50 px-2 py-0.5 rounded\">默认</span>\n              </div>\n            </div>\n          </div>\n          <div v-else class=\"text-center py-4\">\n            <p class=\"text-gray-600 dark:text-gray-400 mb-4\">您还没有添加支付方式</p>\n            <router-link \n              to=\"/payment/methods\"\n              class=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              添加支付方式\n            </router-link>\n          </div>\n        </div>\n\n        <div class=\"flex items-center mb-6\">\n          <input \n            type=\"checkbox\" \n            id=\"auto-renew\"\n            v-model=\"autoRenew\"\n            class=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n          >\n          <label for=\"auto-renew\" class=\"ml-2 block text-sm text-gray-900 dark:text-gray-300\">\n            自动续费\n          </label>\n        </div>\n\n        <div class=\"flex space-x-4\">\n          <button \n            @click=\"selectedPlan = null\"\n            class=\"flex-1 py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n          >\n            取消\n          </button>\n          <button \n            @click=\"confirmSubscription\"\n            :disabled=\"subscriptionStore.loading || !selectedPaymentMethodId\"\n            class=\"flex-1 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            <span v-if=\"subscriptionStore.loading\" class=\"animate-spin -ml-1 mr-2 h-4 w-4 border-2 border-white border-t-transparent rounded-full\"></span>\n            {{ subscriptionStore.loading ? '处理中...' : '确认订阅' }}\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onMounted } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { useSubscriptionStore } from '../../stores/subscription.store';\nimport { usePaymentStore } from '../../stores/payment.store';\nimport { SubscriptionPlan } from '../../services/api/subscription.service';\n\nconst router = useRouter();\nconst subscriptionStore = useSubscriptionStore();\nconst paymentStore = usePaymentStore();\n\nconst selectedPlan = ref<SubscriptionPlan | null>(null);\nconst selectedPaymentMethodId = ref<string>('');\nconst autoRenew = ref(true);\n\n// 加载订阅计划和支付方式\nonMounted(async () => {\n  await subscriptionStore.fetchSubscriptionPlans();\n  await paymentStore.fetchPaymentMethods();\n  \n  // 设置默认支付方式\n  if (paymentStore.defaultPaymentMethod) {\n    selectedPaymentMethodId.value = paymentStore.defaultPaymentMethod.id;\n  }\n});\n\n// 选择计划\nconst selectPlan = (plan: SubscriptionPlan) => {\n  selectedPlan.value = plan;\n};\n\n// 确认订阅\nconst confirmSubscription = async () => {\n  if (!selectedPlan.value || !selectedPaymentMethodId.value) {\n    return;\n  }\n\n  try {\n    await subscriptionStore.createSubscription({\n      plan_id: selectedPlan.value.id,\n      payment_method_id: selectedPaymentMethodId.value,\n      auto_renew: autoRenew.value\n    });\n    \n    // 订阅成功后跳转到我的订阅页面\n    router.push('/subscription/my');\n  } catch (error) {\n    console.error('订阅失败:', error);\n  }\n};\n</script>\n\n<style scoped>\n/* 组件特定样式 */\n</style>"],"names":["router","useRouter","subscriptionStore","useSubscriptionStore","paymentStore","usePaymentStore","selectedPlan","ref","selectedPaymentMethodId","autoRenew","onMounted","selectPlan","plan","confirmSubscription","error","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_unref","_hoisted_2","_toDisplayString","_hoisted_3","_cache","_hoisted_4","_Fragment","_renderList","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","feature","index","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","$event","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","method","_hoisted_32","_hoisted_34","_hoisted_35","_hoisted_36","_createVNode","_component_router_link","_hoisted_37","_hoisted_38","_hoisted_40"],"mappings":"87DAqKA,MAAMA,EAASC,EAAA,EACTC,EAAoBC,EAAA,EACpBC,EAAeC,EAAA,EAEfC,EAAeC,EAA6B,IAAI,EAChDC,EAA0BD,EAAY,EAAE,EACxCE,EAAYF,EAAI,EAAI,EAG1BG,EAAU,SAAY,CACpB,MAAMR,EAAkB,uBAAA,EACxB,MAAME,EAAa,oBAAA,EAGfA,EAAa,uBACfI,EAAwB,MAAQJ,EAAa,qBAAqB,GAEtE,CAAC,EAGD,MAAMO,EAAcC,GAA2B,CAC7CN,EAAa,MAAQM,CACvB,EAGMC,EAAsB,SAAY,CACtC,GAAI,GAACP,EAAa,OAAS,CAACE,EAAwB,OAIpD,GAAI,CACF,MAAMN,EAAkB,mBAAmB,CACzC,QAASI,EAAa,MAAM,GAC5B,kBAAmBE,EAAwB,MAC3C,WAAYC,EAAU,KAAA,CACvB,EAGDT,EAAO,KAAK,kBAAkB,CAChC,OAASc,EAAO,CACd,QAAQ,MAAM,QAASA,CAAK,CAC9B,CACF,yCA9ME,OAAAC,EAAA,EAAAC,EA0JM,MA1JNC,EA0JM,eAzJJC,EAGM,MAAA,CAHD,MAAM,QAAM,CACfA,EAAsE,KAAA,CAAlE,MAAM,kDAAA,EAAmD,MAAI,EACjEA,EAAiE,IAAA,CAA9D,MAAM,uCAAA,EAAwC,cAAY,CAAA,OAIpDC,EAAAjB,CAAA,EAAkB,OAA7Ba,EAAA,EAAAC,EAEM,MAFNI,EAEMC,EADDF,EAAAjB,CAAA,EAAkB,KAAK,EAAA,CAAA,YAIjBiB,EAAAjB,CAAA,EAAkB,SAA7Ba,EAAA,EAAAC,EAEM,MAFNM,EAEM,CAAA,GAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CADJL,EAA6F,MAAA,CAAxF,MAAM,2EAAA,EAA2E,KAAA,EAAA,CAAA,OAIxFH,IAAAC,EAmDM,MAnDNQ,EAmDM,EAlDJT,EAAA,EAAA,EAAAC,EAiDMS,EAAA,KAAAC,EAhDWP,EAAAjB,CAAA,EAAkB,kBAA1BU,QADTI,EAiDM,MAAA,CA/CH,IAAKJ,EAAK,GACX,MAAM,8IAAA,GAENM,EA2CM,MA3CNS,EA2CM,CA1CJT,EAOM,MAPNU,EAOM,CANJV,EAAgF,KAAhFW,EAAgFR,EAAjBT,EAAK,IAAI,EAAA,CAAA,EACxEM,EAA2E,IAA3EY,EAA2ET,EAAvBT,EAAK,WAAW,EAAA,CAAA,EACpEM,EAGM,MAHNa,EAGM,CAFJb,EAAsF,OAAtFc,EAAsFX,EAApBT,EAAK,KAAK,EAAA,CAAA,EAC5EM,EAAkG,OAAlGe,EAAkGZ,EAAhDT,EAAK,QAAQ,EAAG,IAACS,EAAGT,EAAK,aAAa,EAAA,CAAA,CAAA,KAI5FM,EAUM,MAVNgB,EAUM,CATJX,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAL,EAA4E,KAAA,CAAxE,MAAM,wDAAA,EAAyD,OAAI,EAAA,GACvEA,EAOK,KAPLiB,EAOK,EANHpB,EAAA,EAAA,EAAAC,EAKKS,SAL0Bb,EAAK,SAAQ,CAAhCwB,EAASC,SAArBrB,EAKK,KAAA,CAL0C,IAAKqB,EAAO,MAAM,kBAAA,eAC/DnB,EAEM,MAAA,CAFD,MAAM,qCAAqC,KAAK,eAAe,QAAQ,WAAA,GAC1EA,EAA4K,OAAA,CAAtK,YAAU,UAAU,EAAE,qHAAqH,YAAU,SAAA,SAE7JA,EAAmE,OAAnEoB,EAAmEjB,EAAjBe,CAAO,EAAA,CAAA,CAAA,eAK/DlB,EAYM,MAZNqB,EAYM,CAXJhB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAL,EAA4E,KAAA,CAAxE,MAAM,wDAAA,EAAyD,OAAI,EAAA,GACvEA,EASM,MATNsB,EASM,CARJtB,EAGM,MAHNuB,EAGM,CAFJlB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAL,EAA8D,OAAA,CAAxD,MAAM,kCAAA,EAAmC,WAAQ,EAAA,GACvDA,EAA6F,OAA7FwB,EAA6FrB,EAAlCT,EAAK,cAAc,EAAG,QAAK,CAAA,CAAA,GAExFM,EAGM,MAHNyB,GAGM,CAFJpB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAL,EAA4D,OAAA,CAAtD,MAAM,kCAAA,EAAmC,SAAM,EAAA,GACrDA,EAA0F,OAA1F0B,GAA0FvB,EAA/BT,EAAK,YAAY,EAAG,OAAI,CAAA,CAAA,OAKzFM,EAMS,SAAA,CALN,QAAK2B,GAAElC,EAAWC,CAAI,EACtB,SAAUO,EAAAjB,CAAA,EAAkB,QAC7B,MAAM,sPAAA,EACP,SAED,EAAA4C,EAAA,CAAA,gBAMKxC,EAAA,OAAXS,EAAA,EAAAC,EAkFM,MAlFN+B,GAkFM,CAjFJ7B,EAgFM,MAhFN8B,GAgFM,CA/EJ9B,EAOM,MAPN+B,GAOM,CANJ1B,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAL,EAAqE,KAAA,CAAjE,MAAM,iDAAA,EAAkD,OAAI,EAAA,GAChEA,EAAoF,IAApFgC,GAAiD,UAAQ5C,EAAA,MAAa,IAAI,EAAG,MAAG,CAAA,EAChFY,EAGM,MAHNiC,GAGM,CAFJjC,EAA8F,OAA9FkC,GAA8F/B,EAA5Bf,EAAA,MAAa,KAAK,EAAA,CAAA,EACpFY,EAAkH,OAAlHmC,GAAkHhC,EAAhEf,EAAA,MAAa,QAAQ,EAAG,IAACe,EAAGf,EAAA,MAAa,aAAa,EAAA,CAAA,CAAA,KAI5GY,EAwCM,MAxCNoC,GAwCM,CAvCJ/B,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAL,EAA4E,KAAA,CAAxE,MAAM,wDAAA,EAAyD,OAAI,EAAA,GAC5DC,EAAAf,CAAA,EAAa,mBAAmB,OAAM,OAAjDY,EA4BM,MAAAuC,GAAA,EA3BJxC,EAAA,EAAA,EAAAC,EA0BMS,EAAA,KAAAC,EAzBaP,EAAAf,CAAA,EAAa,mBAAvBoD,QADTxC,EA0BM,MAAA,CAxBH,IAAKwC,EAAO,GACb,SAAM,mGAAkG,CAAA,iDAC5ChD,UAA4BgD,EAAO,EAAA,CAAE,CAAA,EAChG,QAAKX,GAAErC,EAAA,MAA0BgD,EAAO,EAAA,GAEzCtC,EAeM,MAfNuC,GAeM,CAdJvC,EAOC,QAAA,CANC,KAAK,QACJ,GAAE,WAAasC,EAAO,EAAE,GACxB,KAAM,iBACN,QAAShD,EAAA,QAA4BgD,EAAO,GAC5C,SAAMX,GAAErC,EAAA,MAA0BgD,EAAO,GAC1C,MAAM,mEAAA,cAERtC,EAKQ,QAAA,CAJL,IAAG,WAAasC,EAAO,EAAE,GAC1B,MAAM,qDAAA,EAEHnC,EAAAmC,EAAO,OAAI,cAAA,GAAwBA,EAAO,KAAK,QAAQA,EAAO,SAAS,GAAKA,EAAO,IAAI,EAAA,EAAAE,EAAA,CAAA,GAGnFF,EAAO,YAAlBzC,IAAAC,EAEM,MAFN2C,GAEM,CAAA,GAAApC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CADJL,EAAgI,OAAA,CAA1H,MAAM,0GAAA,EAA2G,KAAE,EAAA,CAAA,mCAI/HH,EAAA,EAAAC,EAQM,MARN4C,GAQM,CAPJrC,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAL,EAA+D,IAAA,CAA5D,MAAM,uCAAA,EAAwC,aAAU,EAAA,GAC3D2C,EAKcC,EAAA,CAJZ,GAAG,mBACH,MAAM,wNAAA,aACP,IAED,CAAA,GAAAvC,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAA,GAFC,WAED,EAAA,CAAA,gBAIJL,EAUM,MAVN6C,GAUM,GATJ7C,EAKC,QAAA,CAJC,KAAK,WACL,GAAG,kDACMT,EAAS,MAAAoC,GAClB,MAAM,mEAAA,gBADGpC,EAAA,KAAS,CAAA,iBAGpBS,EAEQ,QAAA,CAFD,IAAI,aAAa,MAAM,qDAAA,EAAsD,SAEpF,EAAA,EAAA,GAGFA,EAeM,MAfN8C,GAeM,CAdJ9C,EAKS,SAAA,CAJN,uBAAOZ,EAAA,MAAY,MACpB,MAAM,kRAAA,EACP,MAED,EACAY,EAOS,SAAA,CANN,QAAOL,EACP,SAAUM,EAAAjB,CAAA,EAAkB,UAAYM,EAAA,MACzC,MAAM,sPAAA,GAEMW,EAAAjB,CAAA,EAAkB,SAA9Ba,EAAA,EAAAC,EAA8I,OAA9IiD,EAA8I,cAAA,IAC9I5C,EAAGF,EAAAjB,CAAA,EAAkB,QAAO,SAAA,MAAA,EAAA,CAAA,CAAA"}